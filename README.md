# SF-DS-Batmobil
Университет SkillFactory

Совместная работа команды 4 in 1 DS team@ (Pawel_MTW, FedorAzarov, Tatiana Zhemantseva, Alexander Samokhin)

Описание:
[SF-DST] Car Price prediction Part2

Продолжение соревнования на Прогнозирование стоимости автомобиля но уже с дополнительными данными.
Прогнозирование стоимости автомобиля по характеристикам, описанию и фотографии.

Цели и задачи проекта: создать модель, которая будет предсказывать стоимость автомобиля. Если наша модель работает хорошо, то мы сможем быстро выявлять выгодные предложения (когда желаемая цена продавца ниже предсказанной рыночной цены). Это значительно ускорит работу менеджеров и повысит прибыль компании.
В этом соревновании требуется классифицировать автомобиль, используя табличные данные, текст, изображения по фотографии. Основной целью проекта является изучение принципов работы Multi-Input сетtей и применение различных техник, позволяющих улучшить качество модели.
Задача: Вам поставлена задача создать модель, которая будет предсказывать стоимость автомобиля.

Условия соревнования:
Данное соревнование является бессрочным и доступно для всех потоков.
Срок выполнения соревнования устанавливаеться индивидуально в каждом потоке.
Тестовая выборка представлена в ЛидерБорде целиком.
По этому лучшие и победные решения буду проверяться на их "адекватность" (чтоб не было подгонки под тестовую выборку).
Разрешено использовать внешние данные. (но их источник должен быть публичным и доступен всем участникам соревнования)
Разрешено использовать любые ML и DL алгоритмы и библиотеки.
Даже если удасться найти исходные объявления из теста - нельзя просто указать их цену. Делаем реальный продукт, который потом сможет нормально работать на новых данных.
Дополнительно:
Обратите внимание, что к данному соревнованию прилагается Baseline, который может помочь сформировать вам собственное победное решение

В ходе работы над проектом были решены следующие задачи:

→ EDA

Датасет очищен от дубликатов, пропущенных значений.
Подобраны новые переменные, выполнена нормализация и стандартизация признаков, применены методы для кодирования категориальных признаков.
Произведена генерация новых признаков и отбор признаков методом Стьюдента и коррекляционной матрицей.
→ Построение модели по обработке естественного языка (NLP)

Применены стандартные архитектуры.
Применены различные методы обучения (Fine-tuning, transfer-learning).
Обработка текста: применены дополнительные методы предобработки (аугментация, лемматизация).
Применены продвинутые архитектуры (SOTA) для обработки текста.
→ Добавление изображений в решение

Применены стандартные архитектуры.
Применены различные методы обучения (Fine-tuning, transfer-learning, LR-Cycle).
Обработка изображений: применены дополнительные методы предобработки (аугментация).
Применены продвинутые архитектуры (SOTA) для обработки изображений.
→ Оценка модели и интерпретация результатов

Обучение модели:

Построена «наивная» ML-модель на табличных данных.
Модель градиентного бустинга с помощью CatBoost.
DL (модель NN Tabular)
Multi-Input нейронная сеть для анализа табличных данных и текста
Multi-Input нейронная сеть для анализа табличных данных, текста и изображений
Multi-Input нейронная сеть с пробросом признака
усреднение предсказаний
Информация о данных Все данные, которые использовались в проекте, были взяты с соревнования на Kaggle. На вход подавались изображения с различными моделями автомобилей.

train.csv - the training set test.csv - the test set sample_submission.csv - a sample submission file in the correct format img.zip - image auto https://www.kaggle.com/c/sf-dst-car-price-prediction-part2/data

Файлы в репозитории Репозиторий содержит два ноутбуки:

car_price_part2_best_final.ipynb - командный проект car-price-part2_eda.ipynb - EDA baseline - промежуточный с экспериментами
sf_dst_car_price_part2_-FA-LRA.ipynb - с LR-Cycle.

Никнейм на Kaggle -Pawel_MTW

Значение метрики, которого удалось добиться 10.78708 (на NN1,  простая нейросеть на табличных данных).

Ответы на вопросы Какой частью своей работы вы остались особенно довольны?

Пробовал обучение с различным набором табличных данных, с логарифмированием price и без. Использовал\тестировал различные значения LR, optimizer(adam, adamax, sgd), batch, activation(softmax, relu), разный % выделения данных для тестовых выборки (test_train_split). Подобраны оптимальные гиперпараметры. Эксперементировал с  архитектурой сетей (кол-во  слоев, кол-во нейронов, регулировка Dropout, использование Batch_normalization), попробовал разные сети для работы с картинками: EfficientNetB3, EfficientNetB6. В данном проекте Модель с изображения вообще дает не самый лучший результат. Поработал с обработкой текста: чистка от стоп слов, замена слов и фраз, фильтрация,  лемматизация. Качество обработки текста влияло на MAPE. Применял варианты модели усреднения результата (blend), причем  как с весами,  так и без. Также использовал модель с пробросом признака. Финальным штрихом стало построение мульти-системы  из 100  простых сетей и дальнейшим расчетом среднего предсказания.

Что не получилось сделать так, как хотелось? Над чем ещё стоит поработать?
Не удалось реализовать все задумки по фильтрации текста (еще более детальной). Хотелось попробовать другие текст-сети (Bert и др.)
в этом проекте не удалось дойти до практики с методами обучения (Fine-tuning, LR-Cycle).
